<!-- .github/copilot-instructions.md - Guidance for AI coding agents working on this repo -->

# Quick guide for AI coding agents

This is a small, static browser quiz app (HTML/CSS/vanilla JS) that plays short song snippets and asks the user to guess title/artist. The app has no build step — editing files and opening `index.html` (or serving the folder) is enough to run locally. Use this file to find the project's intent, important files, and concrete patterns to follow.

- Key files

  - `index.html` — UI layout and element IDs. Note: there are duplicate IDs for `game-screen`, `player`, and `status` in the current HTML; be careful when querying by id and prefer the top-most/unique element when modifying structure.
  - `script.js` — Core logic. Contains the `songs` array (metadata + file path + optional `rangeStart`/`rangeEnd`), audio handling, UI wiring, and game flow functions (`startGame`, `nextSong`, `submitGuess`, etc.).
  - `style.css` — Visual theme (background image + color palette).
  - `songs/` — Local audio assets. When adding a new song: add the file here and append an object to `songs` in `script.js`.
  - `.github/workflows/static.yml` — GitHub Pages deploy workflow (push to `main` triggers deployment).

- Big picture / flow to know

  - On Start: `startGame()` copies `songs` to `quizSongs`, shuffles them, and calls `nextSong()`.
  - Playing a snippet: `nextSong()` sets `audio.src` to `currentSong.file`, waits for `onloadedmetadata`, then computes `snippetStart` using `rangeStart`/`rangeEnd` and the UI-configured `snippetLength` and begins playback.
  - Guessing: `submitGuess()` compares the user's input to the target (title or artist) using the repository's `levenshtein()` function and considers answers correct when distance <= 3.
  - Modes: two gameplay modes exist — `easy` (word bank, generated via `renderAnswerBank()`) and `hard` (free text input). Mode selection is handled by `setMode()` and toggles visibility of `#answer-bank` and `#hard-input`.

- Concrete, discoverable patterns & examples

  - songs array entry (add new entries following this shape):
    - { title: "Title", artist: "Artist", file: "songs/your-file.mp3", link?: "https://...", rangeStart?: 0, rangeEnd?: 120 }
  - Snippet selection: `rangeStart`/`rangeEnd` are used as the allowed zone for random snippet starts; if the zone is shorter than the chosen `snippetLength`, the code logs an error and uses `rangeStart` as the snippet start.
  - SFX: there are two approaches in the project — HTML <audio> tags for `sfx-*` and programmatic SFX generated by Web Audio API functions (`playCorrectSFX()`, `playIncorrectSFX()`, `playHintSFX()`). Prefer the Web Audio functions when editing audio behavior, but check `index.html` for referenced sfx files (they may be missing).

- Practical editing notes / watchouts

  - Duplicate IDs: `index.html` currently contains duplicate elements with the same id (`game-screen`, `player`, `status`) — removing or renaming duplicates requires updating `script.js` selectors accordingly.
  - Audio file paths: audio files are expected under `songs/`. If a new file is added, verify the file name matches the `file` field in `songs` and test in-browser (serve via HTTP to avoid CORS/metadata issues).
  - Fuzzy-matching threshold: searches use Levenshtein distance <= 3. If you change this, update `submitGuess()` only.
  - UI wiring: the code depends on specific IDs: `#player`, `#guess`, `#score`, `#progress`, `#answer-bank`, `#hint-count`, `#start-btn`. Keep these IDs unless you update their usages in `script.js` too.

- Running & debugging locally

  - No build step. Recommended quick test server (from the repo root):

    ```powershell
    # Start a simple Python web server and open http://localhost:8000
    python -m http.server 8000
    ```

  - Open devtools console to see helpful logs (e.g. range mismatch message printed in `nextSong()`).

- Deployment

  - Pushing to `main` triggers the Pages workflow at `.github/workflows/static.yml` which uploads the repository as the site artifact. No additional configuration is required in the repo.

- PR checklist (useful for automated edits)
  - If adding songs: add audio file to `songs/` and append object to `songs` in `script.js`; test snippet plays and metadata loads.
  - If changing element IDs or structure: update `script.js` selectors and test gameplay flow (start -> nextSong -> submitGuess).
  - If editing audio logic: test both SFX paths (WebAudio functions and HTML audio tags) and verify they work across browsers.

If anything above is unclear or you want more detail in any section (examples for editing `submitGuess`, adding tests, or cleaning duplicate IDs), say which part and I'll expand or update this file.
